<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>File handling functions</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.70.1">
<link rel="start" href="index.html" title="libgpod Reference Manual">
<link rel="up" href="ch01.html" title="iPod database">
<link rel="prev" href="libgpod-The-Itdb-iTunesDB-structure.html" title="iPod database reading/writing">
<link rel="next" href="libgpod-Time-handling.html" title="Time handling">
<meta name="generator" content="GTK-Doc V1.7 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
<link rel="chapter" href="ch01.html" title="iPod database">
<link rel="chapter" href="ch02.html" title="iPod database components">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2">
<tr valign="middle">
<td><a accesskey="p" href="libgpod-The-Itdb-iTunesDB-structure.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td>
<td><a accesskey="u" href="ch01.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td>
<th width="100%" align="center">libgpod Reference Manual</th>
<td><a accesskey="n" href="libgpod-Time-handling.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td>
</tr>
<tr><td colspan="5" class="shortcuts"><nobr><a href="#id2585793" class="shortcut">Top</a>
                  &#160;|&#160;
                  <a href="#id2584218" class="shortcut">Description</a></nobr></td></tr>
</table>
<div class="refentry" lang="en">
<a name="libgpod-File-handling-functions"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2>
<a name="id2585793"></a><span class="refentrytitle">File handling functions</span>
</h2>
<p>File handling functions &#8212; Functions to copy new files to the iPod</p>
</td>
<td valign="top" align="right"></td>
</tr></table></div>
<div class="refsynopsisdiv">
<h2>Synopsis</h2>
<pre class="synopsis">



gboolean    <a href="libgpod-File-handling-functions.html#itdb-cp-track-to-ipod">itdb_cp_track_to_ipod</a>           (<a href="libgpod-Tracks.html#Itdb-Track">Itdb_Track</a> *track,
                                             gchar *filename,
                                             GError **error);
void        <a href="libgpod-File-handling-functions.html#itdb-filename-fs2ipod">itdb_filename_fs2ipod</a>           (gchar *filename);
void        <a href="libgpod-File-handling-functions.html#itdb-filename-ipod2fs">itdb_filename_ipod2fs</a>           (gchar *ipod_file);
gchar*      <a href="libgpod-File-handling-functions.html#itdb-filename-on-ipod">itdb_filename_on_ipod</a>           (<a href="libgpod-Tracks.html#Itdb-Track">Itdb_Track</a> *track);
gint        <a href="libgpod-File-handling-functions.html#itdb-musicdirs-number">itdb_musicdirs_number</a>           (<a href="libgpod-The-Itdb-iTunesDB-structure.html#Itdb-iTunesDB">Itdb_iTunesDB</a> *itdb);
gboolean    <a href="libgpod-File-handling-functions.html#itdb-rename-files">itdb_rename_files</a>               (const gchar *mp,
                                             GError **error);
</pre>
</div>
<div class="refsect1" lang="en">
<a name="id2584218"></a><h2>Description</h2>
<p>

</p>
</div>
<div class="refsect1" lang="en">
<a name="id2584233"></a><h2>Details</h2>
<div class="refsect2" lang="en">
<a name="id2584244"></a><h3>
<a name="itdb-cp-track-to-ipod"></a>itdb_cp_track_to_ipod ()</h3>
<a class="indexterm" name="id2584255"></a><pre class="programlisting">gboolean    itdb_cp_track_to_ipod           (<a href="libgpod-Tracks.html#Itdb-Track">Itdb_Track</a> *track,
                                             gchar *filename,
                                             GError **error);</pre>
<p>
Copy one track to the iPod. The PC filename is <em class="parameter"><code>filename</code></em>
and is taken literally.
</p>
<p>
The mountpoint of the iPod (in local encoding) is expected in
track-&gt;itdb-&gt;mountpoint.
</p>
<p>
If <em class="parameter"><code>track</code></em>-&gt;transferred is set to TRUE, nothing is done. Upon
successful transfer <em class="parameter"><code>track</code></em>-&gt;transferred is set to TRUE.
</p>
<p>
For storage, the directories "f00 ... fnn" will be
cycled through.
</p>
<p>
The filename is constructed as "gtkpod"&lt;random number&gt; and copied
to <em class="parameter"><code>track</code></em>-&gt;ipod_path. If this file already exists, &lt;random number&gt;
is adjusted until an unused filename is found.
</p>
<p>
If <em class="parameter"><code>track</code></em>-&gt;ipod_path is already set, this one will be used
instead. If a file with this name already exists, it will be
overwritten.
</p>
<p>
<em class="parameter"><code>track</code></em>-&gt;filetype_marker is set according to the filename extension</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term"><em class="parameter"><code>track</code></em>&#160;:</span></td>
<td> the <a href="libgpod-Tracks.html#Itdb-Track"><span class="type">Itdb_Track</span></a> to copy (containing <em class="parameter"><code>filename</code></em> metadata)
</td>
</tr>
<tr>
<td>
<span class="term"><em class="parameter"><code>filename</code></em>&#160;:</span></td>
<td> the source file
</td>
</tr>
<tr>
<td>
<span class="term"><em class="parameter"><code>error</code></em>&#160;:</span></td>
<td> return location for a <span class="type">GError</span> or NULL
</td>
</tr>
<tr>
<td>
<span class="term"><span class="emphasis"><em>Returns</em></span>&#160;:</span></td>
<td> TRUE on success, FALSE on error, in which case <em class="parameter"><code>error</code></em> is
set accordingly.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2577564"></a><h3>
<a name="itdb-filename-fs2ipod"></a>itdb_filename_fs2ipod ()</h3>
<a class="indexterm" name="id2577576"></a><pre class="programlisting">void        itdb_filename_fs2ipod           (gchar *filename);</pre>
<p>
Convert string from casual PC file name to iPod iTunesDB format using ':' 
instead of G_DIR_SEPARATOR_S (ie slashes on Unix-like systems). <em class="parameter"><code>ipod_file</code></em>
is modified in place.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td>
<span class="term"><em class="parameter"><code>filename</code></em>&#160;:</span></td>
<td> a filename 'PC-style' (eg /iPod_Control/Music/f00/test.mp3)
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2577632"></a><h3>
<a name="itdb-filename-ipod2fs"></a>itdb_filename_ipod2fs ()</h3>
<a class="indexterm" name="id2577643"></a><pre class="programlisting">void        itdb_filename_ipod2fs           (gchar *ipod_file);</pre>
<p>
Convert string from from iPod iTunesDB format to casual PC file name
using G_DIR_SEPARATOR (ie slashes on Unix-like systems) instead of ':'.
<em class="parameter"><code>ipod_file</code></em> is modified in place.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td>
<span class="term"><em class="parameter"><code>ipod_file</code></em>&#160;:</span></td>
<td> a filename 'PC-style' (eg /iPod_Control/Music/f00/test.mp3)
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2577700"></a><h3>
<a name="itdb-filename-on-ipod"></a>itdb_filename_on_ipod ()</h3>
<a class="indexterm" name="id2577712"></a><pre class="programlisting">gchar*      itdb_filename_on_ipod           (<a href="libgpod-Tracks.html#Itdb-Track">Itdb_Track</a> *track);</pre>
<p>
Return the full iPod filename as stored in <em class="parameter"><code>track</code></em>.
</p>
<p>
NOTE: NULL is returned when the file does not exist.
</p>
<p>
NOTE: this code works around a problem on some systems (see
<a href="libgpod-Low-level-functions.html#itdb-resolve-path"><code class="function">itdb_resolve_path()</code></a> ) and might return a filename with different
case than the original filename. Don't copy it back to <em class="parameter"><code>track</code></em>
unless you must</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term"><em class="parameter"><code>track</code></em>&#160;:</span></td>
<td> an <a href="libgpod-Tracks.html#Itdb-Track"><span class="type">Itdb_Track</span></a>
</td>
</tr>
<tr>
<td>
<span class="term"><span class="emphasis"><em>Returns</em></span>&#160;:</span></td>
<td> full filename to <em class="parameter"><code>track</code></em> on the iPod or NULL if no
filename is set in <em class="parameter"><code>track</code></em>. Must be freed with <code class="function">g_free()</code> after use.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2583255"></a><h3>
<a name="itdb-musicdirs-number"></a>itdb_musicdirs_number ()</h3>
<a class="indexterm" name="id2583266"></a><pre class="programlisting">gint        itdb_musicdirs_number           (<a href="libgpod-The-Itdb-iTunesDB-structure.html#Itdb-iTunesDB">Itdb_iTunesDB</a> *itdb);</pre>
<p>
Determine the number of F.. directories in iPod_Control/Music.
</p>
<p>
If itdb-&gt;musicdirs is already set, simply return the previously
determined number. Otherwise count the directories first and set
itdb-&gt;musicdirs.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term"><em class="parameter"><code>itdb</code></em>&#160;:</span></td>
<td> an <a href="libgpod-The-Itdb-iTunesDB-structure.html#Itdb-iTunesDB"><span class="type">Itdb_iTunesDB</span></a>
</td>
</tr>
<tr>
<td>
<span class="term"><span class="emphasis"><em>Returns</em></span>&#160;:</span></td>
<td> max number of directories in iPod_Control/Music
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2583341"></a><h3>
<a name="itdb-rename-files"></a>itdb_rename_files ()</h3>
<a class="indexterm" name="id2583354"></a><pre class="programlisting">gboolean    itdb_rename_files               (const gchar *mp,
                                             GError **error);</pre>
<p>
Renames/removes some files on the iPod (Playcounts, OTG
semaphore). May have to be called if you write the iTunesDB not
directly to the iPod but to some other location and then manually
copy the file from there to the iPod.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term"><em class="parameter"><code>mp</code></em>&#160;:</span></td>
<td> mount point of the iPod
</td>
</tr>
<tr>
<td>
<span class="term"><em class="parameter"><code>error</code></em>&#160;:</span></td>
<td> return location for a <span class="type">GError</span> or NULL
</td>
</tr>
<tr>
<td>
<span class="term"><span class="emphasis"><em>Returns</em></span>&#160;:</span></td>
<td> FALSE on error and sets <em class="parameter"><code>error</code></em> accordingly
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</body>
</html>
